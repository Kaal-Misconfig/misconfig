<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Active Directory Rights and Privileges | M1$C0NF1G</title><meta name=keywords content><meta name=description content="Read more.."><meta name=author content="Kaal"><link rel=canonical href=https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-rights-and-privileges/><link crossorigin=anonymous href=/misconfig/assets/css/stylesheet.75aa915a206791d9e04e99cb00c5f8a84001e54711f5670597d62ed6acf7c9b2.css integrity="sha256-daqRWiBnkdngTpnLAMX4qEAB5UcR9WcFl9Yu1qz3ybI=" rel="preload stylesheet" as=style><link rel=icon href=https://Kaal-Misconfig.github.io/misconfig/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Kaal-Misconfig.github.io/misconfig/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Kaal-Misconfig.github.io/misconfig/favicon-32x32.png><link rel=apple-touch-icon href=https://Kaal-Misconfig.github.io/misconfig/apple-touch-icon.png><link rel=mask-icon href=https://Kaal-Misconfig.github.io/misconfig/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-rights-and-privileges/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-rights-and-privileges/"><meta property="og:site_name" content="M1$C0NF1G"><meta property="og:title" content="Active Directory Rights and Privileges"><meta property="og:description" content="Read more.."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Active Directory Rights and Privileges"><meta name=twitter:description content="Read more.."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://Kaal-Misconfig.github.io/misconfig/notes/"},{"@type":"ListItem","position":2,"name":"Active Directory Rights and Privileges","item":"https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-rights-and-privileges/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Active Directory Rights and Privileges","name":"Active Directory Rights and Privileges","description":"Read more..","keywords":[],"articleBody":"Rights are typically assigned to users or groups and deal with permissions to access an object such as file, while privileges grant a user permission to perform an action such as run a program, shut down a system, reset passwords, etc. Privileges can be assigned individually to users or conferred upon them via built-in or custom group membership. Server Operators Get-ADGroup -identity \"Server Operators\" -Properties * adminCount : 1 CanonicalName : INLANEFREIGHT.LOCAL/Builtin/Server Operators CN : Server Operators Created : 10/27/2021 8:14:34 AM createTimeStamp : 10/27/2021 8:14:34 AM Deleted : Description : Members can administer domain servers DisplayName : DistinguishedName : CN=Server Operators,CN=Builtin,DC=INLANEFREIGHT,DC=LOCAL dSCorePropagationData : {10/28/2021 1:47:52 PM, 10/28/2021 1:44:12 PM, 10/28/2021 1:44:11 PM, 10/27/2021 8:50:25 AM...} GroupCategory : Security GroupScope : DomainLocal groupType : -2147483643 HomePage : instanceType : 4 isCriticalSystemObject : True isDeleted : LastKnownParent : ManagedBy : MemberOf : {} Members : {} Modified : 10/28/2021 1:47:52 PM modifyTimeStamp : 10/28/2021 1:47:52 PM Name : Server Operators nTSecurityDescriptor : System.DirectoryServices.ActiveDirectorySecurity ObjectCategory : CN=Group,CN=Schema,CN=Configuration,DC=INLANEFREIGHT,DC=LOCAL ObjectClass : group ObjectGUID : 0887487b-7b07-4d85-82aa-40d25526ec17 objectSid : S-1-5-32-549 ProtectedFromAccidentalDeletion : False SamAccountName : Server Operators sAMAccountType : 536870912 sDRightsEffective : 0 SID : S-1-5-32-549 SIDHistory : {} systemFlags : -1946157056 uSNChanged : 228556 uSNCreated : 12360 whenChanged : 10/28/2021 1:47:52 PM whenCreated : 10/27/2021 8:14:34 AM Domain Admins Get-ADGroup -identity \"Domain Admins\" -properties * | select DistinguishedName, GroupCategory, GroupScope, Name, Members DistinguishedName : CN=Domain Admins,CN=Users,DC=INLANEFREIGHT,DC=LOCAL GroupCategory : Security GroupScope : Global Name : Domain Admins Members : {CN=htb-student_adm,CN=Users,DC=INLANEFREIGHT,DC=LOCAL, CN=sharepoint admin,CN=Users,DC=INLANEFREIGHT,DC=LOCAL, CN=FREIGHTLOGISTICSUSER,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL, CN=PROXYAGENT,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL...} User Rights Assignement Depending on their current group membership, and other factors such as privileges that administrators can assign via Group Policy (GPO), users can have various rights assigned to their account. Some rights granted to an account can lead to unintended consequences such as privilege escalation or access to sensitive files. we could potentially leverage a tool such as SharpGPOAbuse to assign targeted rights to a user. SeRemoteInteractiveLogonRight: This privilege could give our target user the right to log onto a host via Remote Desktop, which could potentially be used to obtain sensitive data or escalate privileges. SeBackupPrivilege: This grants a user the ability to create system backups and could be used to obtain copies of sensitive system files that can be used to retrieve passwords such as the SAM and SYSTEM Registry hives and the NTDS.dit AD database file. SeDebugPrivilege: This allows a user to debug and adjust the memory of a process. With this privilege, attackers could utilize a tool such as Mimikatz to read the memory space of the Local System Authority (LSASS) process and obtain any credentials stored in memeory. SeImpersonatePrivilege: This privilege allows us to impersonate a token of a privileged account such as NT AUTHORITY\\SYSTEM. This could be leveraged with a tool such as JuicyPotato, RogueWinRM, PrintSpoofer, to escalate privileges on a target system. SeLoadDriverPrivilege: A user with this privilege can load and unload device drivers that could potentially be used to escalate privileges or compromise a system. SeTakeOwnershipPrivilege: This allows a process to take ownership of an object. At its most basic level, we could use this privilege to gain access to a file share on a share that was otherwise not accessible to us. ","wordCount":"533","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Kaal"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-rights-and-privileges/"},"publisher":{"@type":"Organization","name":"M1$C0NF1G","logo":{"@type":"ImageObject","url":"https://Kaal-Misconfig.github.io/misconfig/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://Kaal-Misconfig.github.io/misconfig/ accesskey=h title="M1$C0NF1G (Alt + H)">M1$C0NF1G</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://Kaal-Misconfig.github.io/misconfig/posts title=Posts><span>Posts</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/notes title=Notes><span>Notes</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/THM title=THM><span>THM</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/HTB title=HTB><span>HTB</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/tools/ title=Tools><span>Tools</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/tags title=Tags><span>Tags</span></a></li><li><a href=https://Kaal-Misconfig.github.io/misconfig/categories title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Active Directory Rights and Privileges</h1><div class=post-meta><span>3 min</span>&nbsp;·&nbsp;<span>Kaal</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><ul><ul><ul><li><a href=#rights-are-typically-assigned-to-users-or-groups-and-deal-with-permissions-to-access-an-object-such-as-file-while-privileges-grant-a-user-permission-to-perform-an-action-such-as-run-a-program-shut-down-a-system-reset-passwords-etc-privileges-can-be-assigned-individually-to-users-or-conferred-upon-them-via-built-in-or-custom-group-membership aria-label="Rights are typically assigned to users or groups and deal with permissions to access an object such as file, while privileges grant a user permission to perform an action such as run a program, shut down a system, reset passwords, etc. Privileges can be assigned individually to users or conferred upon them via built-in or custom group membership.">Rights are typically assigned to users or groups and deal with permissions to access an object such as file, while privileges grant a user permission to perform an action such as run a program, shut down a system, reset passwords, etc. Privileges can be assigned individually to users or conferred upon them via built-in or custom group membership.</a></li></ul></ul><li><a href=#server-operators aria-label="Server Operators">Server Operators</a></li><li><a href=#domain-admins aria-label="Domain Admins">Domain Admins</a></li></ul></ul><li><a href=#user-rights-assignement aria-label="User Rights Assignement">User Rights Assignement</a><ul><ul><ul><ul><li><a href=#depending-on-their-current-group-membership-and-other-factors-such-as-privileges-that-administrators-can-assign-via-group-policy-gpo-users-can-have-various-rights-assigned-to-their-account-some-rights-granted-to-an-account-can-lead-to-unintended-consequences-such-as-privilege-escalation-or-access-to-sensitive-files-we-could-potentially-leverage-a-tool-such-assharpgpoabuseto-assign-targeted-rights-to-a-user aria-label="Depending on their current group membership, and other factors such as privileges that administrators can assign via Group Policy (GPO), users can have various rights assigned to their account. Some rights granted to an account can lead to unintended consequences such as privilege escalation or access to sensitive files. we could potentially leverage a tool such as SharpGPOAbuse to assign targeted rights to a user.">Depending on their current group membership, and other factors such as privileges that administrators can assign via Group Policy (GPO), users can have various rights assigned to their account. Some rights granted to an account can lead to unintended consequences such as privilege escalation or access to sensitive files. we could potentially leverage a tool such as SharpGPOAbuse to assign targeted rights to a user.</a></li></ul></ul></ul></ul></li></ul></div></details></div><div class=post-content><h5 id=rights-are-typically-assigned-to-users-or-groups-and-deal-with-permissions-to-access-an-object-such-as-file-while-privileges-grant-a-user-permission-to-perform-an-action-such-as-run-a-program-shut-down-a-system-reset-passwords-etc-privileges-can-be-assigned-individually-to-users-or-conferred-upon-them-via-built-in-or-custom-group-membership>Rights are typically assigned to users or groups and deal with permissions to access an object such as file, while privileges grant a user permission to perform an action such as run a program, shut down a system, reset passwords, etc. Privileges can be assigned individually to users or conferred upon them via built-in or custom group membership.<a hidden class=anchor aria-hidden=true href=#rights-are-typically-assigned-to-users-or-groups-and-deal-with-permissions-to-access-an-object-such-as-file-while-privileges-grant-a-user-permission-to-perform-an-action-such-as-run-a-program-shut-down-a-system-reset-passwords-etc-privileges-can-be-assigned-individually-to-users-or-conferred-upon-them-via-built-in-or-custom-group-membership>#</a></h5><h3 id=server-operators>Server Operators<a hidden class=anchor aria-hidden=true href=#server-operators>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span>Get-ADGroup -identity <span style=color:#e6db74>&#34;Server Operators&#34;</span> -Properties *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>adminCount                      <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>CanonicalName                   <span style=color:#960050;background-color:#1e0010>:</span> INLANEFREIGHT.LOCAL/Builtin/Server Operators
</span></span><span style=display:flex><span>CN                              <span style=color:#960050;background-color:#1e0010>:</span> Server Operators
</span></span><span style=display:flex><span>Created                         <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>27</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>8</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>14</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>34</span> AM
</span></span><span style=display:flex><span>createTimeStamp                 <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>27</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>8</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>14</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>34</span> AM
</span></span><span style=display:flex><span>Deleted                         <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>Description                     <span style=color:#960050;background-color:#1e0010>:</span> Members can administer domain servers
</span></span><span style=display:flex><span>DisplayName                     <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>DistinguishedName               <span style=color:#960050;background-color:#1e0010>:</span> CN=Server Operators,CN=Builtin,DC=INLANEFREIGHT,DC=LOCAL
</span></span><span style=display:flex><span>dSCorePropagationData           <span style=color:#960050;background-color:#1e0010>:</span> {<span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>47</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span> PM, <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>44</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>12</span> PM, <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>44</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>11</span> PM, <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>27</span>/<span style=color:#ae81ff>2021</span> 
</span></span><span style=display:flex><span>                                  <span style=color:#ae81ff>8</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>50</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>25</span> AM...}
</span></span><span style=display:flex><span>GroupCategory                   <span style=color:#960050;background-color:#1e0010>:</span> Security
</span></span><span style=display:flex><span>GroupScope                      <span style=color:#960050;background-color:#1e0010>:</span> DomainLocal
</span></span><span style=display:flex><span>groupType                       <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>-2147483643</span>
</span></span><span style=display:flex><span>HomePage                        <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>instanceType                    <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>isCriticalSystemObject          <span style=color:#960050;background-color:#1e0010>:</span> True
</span></span><span style=display:flex><span>isDeleted                       <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>LastKnownParent                 <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>ManagedBy                       <span style=color:#960050;background-color:#1e0010>:</span> 
</span></span><span style=display:flex><span>MemberOf                        <span style=color:#960050;background-color:#1e0010>:</span> {}
</span></span><span style=display:flex><span>Members                         <span style=color:#960050;background-color:#1e0010>:</span> {}
</span></span><span style=display:flex><span>Modified                        <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>47</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span> PM
</span></span><span style=display:flex><span>modifyTimeStamp                 <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>47</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span> PM
</span></span><span style=display:flex><span>Name                            <span style=color:#960050;background-color:#1e0010>:</span> Server Operators
</span></span><span style=display:flex><span>nTSecurityDescriptor            <span style=color:#960050;background-color:#1e0010>:</span> System.DirectoryServices.ActiveDirectorySecurity
</span></span><span style=display:flex><span>ObjectCategory                  <span style=color:#960050;background-color:#1e0010>:</span> CN=Group,CN=Schema,CN=Configuration,DC=INLANEFREIGHT,DC=LOCAL
</span></span><span style=display:flex><span>ObjectClass                     <span style=color:#960050;background-color:#1e0010>:</span> group
</span></span><span style=display:flex><span>ObjectGUID                      <span style=color:#960050;background-color:#1e0010>:</span> 0887487b-7b07-4d85-82aa-40d25526ec17
</span></span><span style=display:flex><span>objectSid                       <span style=color:#960050;background-color:#1e0010>:</span> S-<span style=color:#ae81ff>1</span>-<span style=color:#ae81ff>5</span>-<span style=color:#ae81ff>32</span>-<span style=color:#ae81ff>549</span>
</span></span><span style=display:flex><span>ProtectedFromAccidentalDeletion <span style=color:#960050;background-color:#1e0010>:</span> False
</span></span><span style=display:flex><span>SamAccountName                  <span style=color:#960050;background-color:#1e0010>:</span> Server Operators
</span></span><span style=display:flex><span>sAMAccountType                  <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>536870912</span>
</span></span><span style=display:flex><span>sDRightsEffective               <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>SID                             <span style=color:#960050;background-color:#1e0010>:</span> S-<span style=color:#ae81ff>1</span>-<span style=color:#ae81ff>5</span>-<span style=color:#ae81ff>32</span>-<span style=color:#ae81ff>549</span>
</span></span><span style=display:flex><span>SIDHistory                      <span style=color:#960050;background-color:#1e0010>:</span> {}
</span></span><span style=display:flex><span>systemFlags                     <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>-1946157056</span>
</span></span><span style=display:flex><span>uSNChanged                      <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>228556</span>
</span></span><span style=display:flex><span>uSNCreated                      <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>12360</span>
</span></span><span style=display:flex><span>whenChanged                     <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>28</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>47</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span> PM
</span></span><span style=display:flex><span>whenCreated                     <span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#ae81ff>10</span>/<span style=color:#ae81ff>27</span>/<span style=color:#ae81ff>2021</span> <span style=color:#ae81ff>8</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>14</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>34</span> AM
</span></span></code></pre></div><h3 id=domain-admins>Domain Admins<a hidden class=anchor aria-hidden=true href=#domain-admins>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-PowerShell data-lang=PowerShell><span style=display:flex><span>Get-ADGroup -identity <span style=color:#e6db74>&#34;Domain Admins&#34;</span> -properties * | select DistinguishedName, GroupCategory, GroupScope, Name, Members
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DistinguishedName <span style=color:#960050;background-color:#1e0010>:</span> CN=Domain Admins,CN=Users,DC=INLANEFREIGHT,DC=LOCAL
</span></span><span style=display:flex><span>GroupCategory     <span style=color:#960050;background-color:#1e0010>:</span> Security
</span></span><span style=display:flex><span>GroupScope        <span style=color:#960050;background-color:#1e0010>:</span> Global
</span></span><span style=display:flex><span>Name              <span style=color:#960050;background-color:#1e0010>:</span> Domain Admins
</span></span><span style=display:flex><span>Members           <span style=color:#960050;background-color:#1e0010>:</span> {CN=htb-student_adm,CN=Users,DC=INLANEFREIGHT,DC=LOCAL, CN=sharepoint admin,CN=Users,DC=INLANEFREIGHT,DC=LOCAL, CN=FREIGHTLOGISTICSUSER,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL, CN=PROXYAGENT,OU=Service Accounts,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL...}
</span></span></code></pre></div><h1 id=user-rights-assignement>User Rights Assignement<a hidden class=anchor aria-hidden=true href=#user-rights-assignement>#</a></h1><h5 id=depending-on-their-current-group-membership-and-other-factors-such-as-privileges-that-administrators-can-assign-via-group-policy-gpo-users-can-have-various-rights-assigned-to-their-account-some-rights-granted-to-an-account-can-lead-to-unintended-consequences-such-as-privilege-escalation-or-access-to-sensitive-files-we-could-potentially-leverage-a-tool-such-assharpgpoabuseto-assign-targeted-rights-to-a-user>Depending on their current group membership, and other factors such as privileges that administrators can assign via Group Policy (GPO), users can have various rights assigned to their account. Some rights granted to an account can lead to unintended consequences such as privilege escalation or access to sensitive files. we could potentially leverage a tool such as <a href=https://github.com/FSecureLABS/SharpGPOAbuse>SharpGPOAbuse</a> to assign targeted rights to a user.<a hidden class=anchor aria-hidden=true href=#depending-on-their-current-group-membership-and-other-factors-such-as-privileges-that-administrators-can-assign-via-group-policy-gpo-users-can-have-various-rights-assigned-to-their-account-some-rights-granted-to-an-account-can-lead-to-unintended-consequences-such-as-privilege-escalation-or-access-to-sensitive-files-we-could-potentially-leverage-a-tool-such-assharpgpoabuseto-assign-targeted-rights-to-a-user>#</a></h5><ol><li><strong>SeRemoteInteractiveLogonRight</strong>: This privilege could give our target user the right to log onto a host via Remote Desktop, which could potentially be used to obtain sensitive data or escalate privileges.</li><li><strong>SeBackupPrivilege</strong>: This grants a user the ability to create system backups and could be used to obtain copies of sensitive system files that can be used to retrieve passwords such as the SAM and SYSTEM Registry hives and the NTDS.dit AD database file.</li><li><strong>SeDebugPrivilege</strong>: This allows a user to debug and adjust the memory of a process. With this privilege, attackers could utilize a tool such as Mimikatz to read the memory space of the Local System Authority (LSASS) process and obtain any credentials stored in memeory.</li><li><strong>SeImpersonatePrivilege</strong>: This privilege allows us to impersonate a token of a privileged account such as NT AUTHORITY\SYSTEM. This could be leveraged with a tool such as JuicyPotato, RogueWinRM, PrintSpoofer, to escalate privileges on a target system.</li><li><strong>SeLoadDriverPrivilege</strong>: A user with this privilege can load and unload device drivers that could potentially be used to escalate privileges or compromise a system.</li><li><strong>SeTakeOwnershipPrivilege</strong>: This allows a process to take ownership of an object. At its most basic level, we could use this privilege to gain access to a file share on a share that was otherwise not accessible to us.</li></ol></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://Kaal-Misconfig.github.io/misconfig/notes/active-directory-objects/><span class=title>« Prev</span><br><span>Active Directory Objects</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://Kaal-Misconfig.github.io/misconfig/>M1$C0NF1G</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>